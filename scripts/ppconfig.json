{"name":"BiliPWA","url":"https://www.bilibili.com","showName":"哔哩哔哩PWA","appid":"com.BiliPWA.app","icon":"","iconRound":false,"state":true,"single":true,"injectJq":true,"tauriApi":false,"devbug":false,"version":"0.0.1","preview":"desktop","platform":["1-1"],"width":800,"height":600,"desc":"","jsFile":[],"filterCss":".watchlater-pip-button","customJs":"console.log(\n  '%cbuild from PakePlus： https://github.com/Sjj1024/PakePlus',\n  'color:orangered;font-weight:bolder'\n);\n\n(function removeWatchlaterPipButtonSmartly() {\n    let tryCount = 0;\n    const maxTries = 20;\n    const interval = 300; // 每300ms尝试一次，总尝试6秒\n\n    const timer = setInterval(() => {\n        const el = document.querySelector('.watchlater-pip-button');\n        if (el) {\n            el.remove();\n            console.log('[PakePlus] 已移除稍后再看按钮');\n            clearInterval(timer);\n        } else if (++tryCount >= maxTries) {\n            clearInterval(timer);\n            console.log('[PakePlus] 未找到稍后再看按钮，停止尝试');\n        }\n    }, interval);\n})();\n\n// ✅ PakePlus 默认的点击拦截逻辑（保留）\n//const hookClick = (e) => {\n//  const origin = e.target.closest('a');\n//  const isBaseTargetBlank = document.querySelector('head base[target=\"_blank\"]');\n//  console.log('origin', origin, isBaseTargetBlank);\n//  if (\n//    (origin && origin.href && origin.target === '_blank') ||\n//    (origin && origin.href && isBaseTargetBlank)\n//  ) {\n//    e.preventDefault();\n//    console.log('handle origin', origin);\n//    location.href = origin.href;\n//  } else {\n//    console.log('not handle origin', origin);\n//  }\n//};\n\n//document.addEventListener('click', hookClick, { capture: true });\n\n// ✅ 劫持 window.open，强制在当前页打开\ntry {\n  window.open = new Proxy(window.open, {\n    apply(target, ctx, args) {\n      let [url, targetName = '_blank', features] = args;\n      if (typeof url === 'string' && url.startsWith('//')) {\n        url = location.protocol + url;\n      }\n      return Reflect.apply(target, ctx, [url, '_self', features]);\n    }\n  });\n} catch (e) {\n  console.error('Error locking window.open:', e);\n}\n\n// ✅ 禁止 Ctrl+滚轮 和 手势缩放\nwindow.addEventListener('wheel', e => {\n  if (e.ctrlKey) e.preventDefault();\n}, { passive: false });\n\n['gesturestart', 'gesturechange', 'gestureend'].forEach(type => {\n  window.addEventListener(type, e => e.preventDefault());\n});\n\n// ✅ 移除所有链接的 target=\"_blank\"\nconst cleanLinks = (root = document) => {\n  root.querySelectorAll('a[target=\"_blank\"]').forEach(a => a.removeAttribute('target'));\n};\ncleanLinks();\n\n// ✅ 设置 MutationObserver 自动清除新生成的 target=\"_blank\"\nconst observer = new MutationObserver(mutations => {\n  for (const m of mutations) {\n    if (m.type === 'attributes' && m.target.tagName === 'A') {\n      m.target.removeAttribute('target');\n    } else if (m.addedNodes.length) {\n      m.addedNodes.forEach(node => {\n        if (node.nodeType === 1) cleanLinks(node);\n      });\n    }\n  }\n});\n\nobserver.observe(document.documentElement, {\n  childList: true,\n  subtree: true,\n  attributes: true,\n  attributeFilter: ['target']\n});\n\n\n\n// ✅ 样式修复（防止组件遮挡、统一字体）\nconst style = document.createElement('style');\nstyle.textContent = `\n  html, body { font-family: initial !important; }\n  div[data-cy=EvaRenderer_LayerWrapper]:has(.player) { z-index: 999999; }\n  .fixedPageBackground_root { z-index: 999999 !important; }\n`;\ndocument.head.appendChild(style);\n\n// ✅ 解锁专栏文章的复制权限、屏蔽充电面板\nif (location.href.startsWith('https://www.bilibili.com/read/cv')) {\n  try {\n    if (window.__INITIAL_STATE__?.elecFullInfo) {\n      window.__INITIAL_STATE__.elecFullInfo.list = [];\n    }\n    const holder = document.querySelector('.article-holder');\n    if (holder) {\n      holder.classList.remove(\"unable-reprint\");\n      holder.addEventListener('copy', e => e.stopImmediatePropagation(), true);\n    }\n  } catch (e) {\n    console.error('文章区修改失败:', e);\n  }\n}\n","isHtml":false,"htmlPath":"","htmlFiles":[],"more":{"windows":{"label":"BiliPWA","title":"哔哩哔哩PWA","url":"https://www.bilibili.com","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36","width":1280,"height":720,"theme":null,"resizable":true,"fullscreen":false,"maximized":true,"minWidth":400,"minHeight":300,"maxWidth":1920,"maxHeight":1280,"decorations":true,"transparent":false,"titleBarStyle":"Visible","visible":true,"focus":true,"closable":true,"minimizable":true,"maximizable":true,"alwaysOnTop":false,"alwaysOnBottom":false,"center":true,"skipTaskbar":false,"tabbingIdentifier":null,"parent":null,"dragDropEnabled":true,"browserExtensionsEnabled":false,"devtools":true,"contentProtected":false,"hiddenTitle":false,"incognito":false,"proxyUrl":null,"useHttpsScheme":false,"zoomHotkeysEnabled":false,"acceptFirstMouse":false,"create":false}},"phone":{"safeArea":{"top":0,"bottom":0,"left":0,"right":0},"header":{"show":false,"title":"","backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","loading":false,"toolBar":false,"toolBarBackgroundColor":"","toolBarColor":"","toolBarFontSize":16,"toolBarFontWeight":"bold"},"siderMenu":{"show":false,"width":0,"backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","title":"","titleColor":"","titleFontSize":16,"titleFontWeight":"bold"},"tabBar":{"show":false,"backgroundColor":"","color":"","activeColor":"","fontSize":16,"fontWeight":"bold","tabBarItem":[]},"webview":{"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36","javaScriptEnabled":true,"domStorageEnabled":true,"allowFileAccess":true,"loadWithOverviewMode":true,"setSupportZoom":true,"clearCache":true}},"ios":{"name":"BiliPWA","showName":"哔哩哔哩PWA","version":"0.0.1","webUrl":"https://www.bilibili.com","id":"com.BiliPWA.app.ios","icon":"./app-icon.png","desc":"PakePlus Project by 1024xiaoshen","pubBody":"PakePlus android build body","isHtml":false,"debug":false},"android":{"name":"BiliPWA","showName":"哔哩哔哩PWA","version":"0.0.1","webUrl":"https://www.bilibili.com","id":"com.BiliPWA.app.android","icon":"./app-icon.png","input":"./app-icon.png","output":"./res","rounded":true,"copyTo":"./app/src/main/res","androidResDir":"./app/src/main/res","desc":"PakePlus Project by 1024xiaoshen","pubBody":"PakePlus android build body","isHtml":false,"debug":false},"desktop":{"name":"BiliPWA","showName":"哔哩哔哩PWA","version":"0.0.1","id":"com.BiliPWA.app.desktop","desc":"PakePlus Project by 1024xiaoshen","webUrl":"https://www.bilibili.com","iconPath":"../app-icon.png","inputPath":"../app-icon.png","tempPath":"./processed-image.png","icnsPath":"../src-tauri/icons/icon.icns","pubBody":"PakePlus desktop build body","isHtml":false,"single":true,"state":true,"injectJq":false,"tauriApi":true,"debug":false}}